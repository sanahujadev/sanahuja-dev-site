---
import { getTranslations, type Privacy } from "../../../i18n/utils";
import Layout from "../../../layouts/Layout.astro";

export function getStaticPaths() {
  return [{ params: { lang: "en" } }, { params: { lang: "es" } }];
}

const { lang } = Astro.params;
const t = getTranslations(lang as "en" | "es");

const privacy = t.privacy as Privacy;
---

<Layout t={t} lang={lang}>
  <main class="container mx-auto px-4 py-16">
    <h1 class="text-4xl font-bold text-center mb-8 dark:text-text-default-dark">{privacy.title}</h1>
    <p class="text-center text-text-muted dark:text-text-muted-dark mb-12">{privacy.lastUpdated}</p>
    <div class="prose dark:prose-invert mx-auto">
      {privacy.sections.map((section: any) => (
        <section>
          <h2 class="dark:text-text-default-dark">{section.title}</h2>
          {section.content && (Array.isArray(section.content) ? (
            section.content.map((p: string) => <p class="dark:text-text-muted-dark">{p}</p>)
          ) : (
            <p class="dark:text-text-muted-dark">{section.content}</p>
          ))}
          {section.subsections && section.subsections.map((subsection: any) => (
            <div>
              <h3 class="dark:text-text-default-dark">{subsection.title}</h3>
              {Array.isArray(subsection.content) ? (
                subsection.content.map((p: string) => <p class="dark:text-text-muted-dark">{p}</p>)
              ) : (
                <p class="dark:text-text-muted-dark">{subsection.content}</p>
              )}
              {subsection.table && (
                <div class="overflow-x-auto">
                  <table class="w-full text-left border-collapse dark:text-text-muted-dark">
                    <thead>
                      <tr>
                        {subsection.table.headers.map((header: string) => <th class="border-b-2 p-2 dark:border-border-darker">{header}</th>)}
                      </tr>
                    </thead>
                    <tbody>
                      {subsection.table.rows.map((row: string[]) => (
                        <tr>
                          {row.map((cell: string) => <td class="border-b p-2 dark:border-border-darker">{cell}</td>)}
                        </tr>
                      ))}
                    </tbody>
                  </table>
                </div>
              )}
              {subsection.note && <p class="text-sm mt-4 dark:text-text-muted-dark"><em>{subsection.note}</em></p>}
            </div>
          ))}
        </section>
      ))}
    </div>
  </main>
</Layout>
